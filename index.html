<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Floresta das 99 Noites</title>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef}=React;const R=40;const App=()=>{const m=useRef(null),M=useRef(null),u=useRef(null),L=useRef([]);const load=()=>{const s=localStorage.getItem('f99n');if(s){try{return JSON.parse(s)}catch(e){}}return null};const sv=load();const[sc,setSc]=useState(sv?.screen||'splash'),[pt,setPt]=useState(sv?.points||0),[hp,setHp]=useState(sv?.playerHealth||100),[inv,setInv]=useState(sv?.inventory||[]),[disc,setDisc]=useState(sv?.discoveredLocations||[]),[cur,setCur]=useState(null),[pos,setPos]=useState(null),[gm,setGm]=useState(sv?.gameMode||null),[locs,setLocs]=useState(sv?.locations||[]),[bat,setBat]=useState(false),[en,setEn]=useState(null),[miss,setMiss]=useState(sv?.missions||[{id:1,name:'Encontre 3 Cultistas',progress:0,target:3,reward:15,completed:false},{id:2,name:'Colete 5 Itens',progress:0,target:5,reward:10,completed:false},{id:3,name:'Derrote o Alpha Wolf',progress:0,target:1,reward:30,completed:false}]);useEffect(()=>{localStorage.setItem('f99n',JSON.stringify({screen:sc,points:pt,playerHealth:hp,inventory:inv,discoveredLocations:disc,gameMode:gm,locations:locs,missions:miss}))},[sc,pt,hp,inv,disc,gm,locs,miss]);const cr=[{id:'deer',name:'O Cervo',type:'legendary',points:30,rarity:'Lendário',isEnemy:true,health:100,damage:25,icon:'🦌'},{id:'owl',name:'A Coruja',type:'legendary',points:30,rarity:'Lendário',isEnemy:true,health:80,damage:20,icon:'🦉'},{id:'ram',name:'O Carneiro',type:'legendary',points:30,rarity:'Lendário',isEnemy:true,health:90,damage:22,icon:'🐏'},{id:'alpha_wolf',name:'Alpha Wolf',type:'epic',points:20,rarity:'Épico',isEnemy:true,health:60,damage:18,icon:'🐺'},{id:'cultist_king',name:'Cultist King',type:'epic',points:20,rarity:'Épico',isEnemy:true,health:70,damage:20,icon:'👑'},{id:'bear',name:'Urso',type:'epic',points:20,rarity:'Épico',isEnemy:true,health:80,damage:25,icon:'🐻'},{id:'flashlight',name:'Lanterna',type:'epic',points:20,rarity:'Épico',isEnemy:false,icon:'🔦'},{id:'katana',name:'Katana',type:'epic',points:20,rarity:'Épico',isEnemy:false,icon:'⚔️'},{id:'wolf',name:'Lobo',type:'rare',points:10,rarity:'Raro',isEnemy:true,health:40,damage:12,icon:'🐺'},{id:'cultist',name:'Cultista',type:'rare',points:10,rarity:'Raro',isEnemy:true,health:30,damage:10,icon:'🧙'},{id:'crossbow_cultist',name:'Cultista Arqueiro',type:'rare',points:10,rarity:'Raro',isEnemy:true,health:25,damage:15,icon:'🏹'},{id:'fox',name:'Raposa',type:'rare',points:10,rarity:'Raro',isEnemy:false,icon:'🦊'},{id:'torch',name:'Tocha',type:'rare',points:10,rarity:'Raro',isEnemy:false,icon:'🔥'},{id:'armor',name:'Armadura',type:'rare',points:10,rarity:'Raro',isEnemy:false,icon:'🛡️'},{id:'rabbit',name:'Coelho',type:'common',points:5,rarity:'Comum',isEnemy:false,icon:'🐰'},{id:'wood',name:'Madeira',type:'common',points:5,rarity:'Comum',isEnemy:false,icon:'🪵'},{id:'mushroom',name:'Cogumelo',type:'common',points:5,rarity:'Comum',isEnemy:false,icon:'🍄'},{id:'crystal',name:'Cristal',type:'common',points:5,rarity:'Comum',isEnemy:false,icon:'💎'},{id:'branch',name:'Galho',type:'common',points:5,rarity:'Comum',isEnemy:false,icon:'🌿'}];const jl=[{lat:-27.4521,lng:-48.4947,name:'Praia Jurerê',creature:'deer'},{lat:-27.4535,lng:-48.4962,name:'Open Shopping',creature:'cultist_king'},{lat:-27.451,lng:-48.493,name:'Praça',creature:'alpha_wolf'},{lat:-27.4528,lng:-48.4955,name:'Av Búzios',creature:'owl'},{lat:-27.4515,lng:-48.494,name:'Calçadão',creature:'wolf'},{lat:-27.454,lng:-48.497,name:'Parque',creature:'bear'},{lat:-27.4505,lng:-48.4925,name:'Píer',creature:'cultist'},{lat:-27.4525,lng:-48.495,name:'Mirante',creature:'flashlight'},{lat:-27.4518,lng:-48.4945,name:'Quiosque',creature:'torch'},{lat:-27.4512,lng:-48.4935,name:'Bosque',creature:'rabbit'},{lat:-27.4532,lng:-48.4958,name:'Marina',creature:'fox'},{lat:-27.4508,lng:-48.4933,name:'Esportes',creature:'wood'},{lat:-27.4522,lng:-48.4952,name:'Restaurante',creature:'mushroom'},{lat:-27.4538,lng:-48.4968,name:'IL Campanario',creature:'crystal'},{lat:-27.4516,lng:-48.4942,name:'Salva-Vidas',creature:'branch'},{lat:-27.453,lng:-48.496,name:'Beach Club',creature:'crossbow_cultist'},{lat:-27.4513,lng:-48.4938,name:'Vôlei',creature:'armor'},{lat:-27.4527,lng:-48.4954,name:'Ciclovia',creature:'katana'},{lat:-27.452,lng:-48.4948,name:'Parque Infantil',creature:'ram'}];useEffect(()=>{if(navigator.geolocation){navigator.geolocation.watchPosition(p=>{const n={lat:p.coords.latitude,lng:p.coords.longitude};setPos(n);if(M.current&&u.current)u.current.setLatLng([n.lat,n.lng])},e=>console.log('GPS:',e),{enableHighAccuracy:true})}},[]);const dist=(a,b,c,d)=>{const E=6371e3,f=a*Math.PI/180,g=c*Math.PI/180,h=(c-a)*Math.PI/180,i=(d-b)*Math.PI/180,j=Math.sin(h/2)*Math.sin(h/2)+Math.cos(f)*Math.cos(g)*Math.sin(i/2)*Math.sin(i/2);return E*2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j))};useEffect(()=>{if(pos&&locs.length>0)locs.forEach(l=>{if(!disc.includes(l.id)&&dist(pos.lat,pos.lng,l.lat,l.lng)<=R)discover(l)})},[pos,locs]);useEffect(()=>{if(sc==='map'&&m.current&&!M.current){const i=pos||{lat:-27.4521,lng:-48.4947},mp=L.map(m.current).setView([i.lat,i.lng],16);L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mp);if(pos){const ic=L.divIcon({html:'<div style="background:#3b82f6;width:20px;height:20px;border-radius:50%;border:3px solid #fff"></div>',iconSize:[20,20]});u.current=L.marker([pos.lat,pos.lng],{icon:ic}).addTo(mp)}M.current=mp}if(sc==='map'&&M.current&&locs.length>0){L.current.forEach(mk=>mk.remove());L.current=[];locs.forEach(l=>{const c=cr.find(x=>x.id===l.creature),d=disc.includes(l.id),col=d?'#10b981':c.type==='legendary'?'#a855f7':c.type==='epic'?'#eab308':c.type==='rare'?'#3b82f6':'#6b7280',ic=L.divIcon({html:`<div style="background:${col};width:30px;height:30px;border-radius:50%;border:2px solid #fff;display:flex;align-items:center;justify-content:center;font-size:18px">${c.icon}</div>`,iconSize:[30,30]}),mk=L.marker([l.lat,l.lng],{icon:ic}).bindPopup(`<b>${l.name}</b><br>${c.name}`).addTo(M.current);L.current.push(mk)})}},[sc,locs,pos,disc]);const discover=l=>{const c=cr.find(x=>x.id===l.creature);setCur({...l,creature:c});setDisc([...disc,l.id]);c.isEnemy?(setEn({...c,currentHealth:c.health}),setBat(true),setSc('battle')):setSc('discovery')};const force=l=>{!disc.includes(l.id)&&discover(l)};const collect=()=>{const c=cur.creature;setPt(pt+c.points);setInv([...inv,c]);upMiss(c);setSc('map');setCur(null)};const upMiss=c=>{setMiss(miss.map(ms=>{if(ms.id===1&&c.id.includes('cultist')&&!ms.completed){const p=ms.progress+1;if(p>=ms.target){setPt(x=>x+ms.reward);return{...ms,progress:p,completed:true}}return{...ms,progress:p}}if(ms.id===2&&!ms.completed){const p=ms.progress+1;if(p>=ms.target){setPt(x=>x+ms.reward);return{...ms,progress:p,completed:true}}return{...ms,progress:p}}return ms}))};const atk=()=>{const nh=en.currentHealth-20;if(nh<=0){setPt(pt+en.points);setInv([...inv,en]);if(en.id==='alpha_wolf'){setMiss(miss.map(ms=>ms.id===3?{...ms,progress:1,completed:true}:ms));setPt(p=>p+30)}upMiss(en);setBat(false);setEn(null);setSc('map')}else{setEn({...en,currentHealth:nh});setTimeout(()=>{const np=hp-en.damage;if(np<=0){alert('Derrotado!');setBat(false);setEn(null);setHp(100);setSc('map')}else setHp(np)},500)}};const flee=()=>{setBat(false);setEn(null);setSc('map')};const genLocal=()=>{if(!pos){alert('Aguardando GPS...');return}const nl=[];for(let i=0;i<15;i++){const c=cr[Math.floor(Math.random()*cr.length)],a=Math.random()*2*Math.PI,d=50+Math.random()*100,la=pos.lat+(d/111000)*Math.cos(a),ln=pos.lng+(d/(111000*Math.cos(pos.lat*Math.PI/180)))*Math.sin(a);nl.push({id:`l${i}`,lat:la,lng:ln,name:`Ponto ${i+1}`,creature:c.id})}setLocs(nl);setGm('local');setSc('map')};const startJ=()=>{setLocs(jl.map((l,i)=>({...l,id:`j${i}`})));setGm('jurere');setSc('map')};const reset=()=>{if(confirm('Resetar?')){localStorage.removeItem('f99n');window.location.reload()}};const rank=()=>{if(pt>=76)return{name:'Diamante',icon:'💎',color:'text-cyan-400'};if(pt>=51)return{name:'Ouro',icon:'🥇',color:'text-yellow-400'};if(pt>=26)return{name:'Prata',icon:'🥈',color:'text-gray-300'};return{name:'Bronze',icon:'🥉',color:'text-orange-400'}};const rk=rank();if(sc==='splash')return <div className="min-h-screen bg-gradient-to-b from-gray-900 via-green-900 to-black flex items-center justify-center p-6"><div className="text-center"><div className="text-8xl mb-4">🌲</div><h1 className="text-4xl font-bold text-white mb-2">Floresta das</h1><h1 className="text-5xl font-bold text-green-400 mb-4">99 Noites</h1><p className="text-xl text-gray-300">Jurerê</p><button onClick={()=>setSc('menu')}className="mt-8 bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg text-xl font-bold">INICIAR</button>{sv&&<p className="text-sm text-green-400 mt-4">✓ Progresso salvo</p>}</div></div>;if(sc==='menu')return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6"><div className="max-w-md mx-auto"><h1 className="text-3xl font-bold text-center mb-8 text-green-400">Menu</h1><div className="bg-gray-800 rounded-lg p-4 mb-6"><div className="flex items-center justify-between"><div><p className="text-gray-400">Pontos</p><p className="text-3xl font-bold">{pt}/100</p></div><div className="text-right"><p className="text-gray-400">Rank</p><p className={`text-2xl font-bold ${rk.color}`}>{rk.icon} {rk.name}</p></div></div><div className="w-full bg-gray-700 rounded-full h-3 mt-4"><div className="bg-green-500 h-3 rounded-full"style={{width:`${pt}%`}}/></div></div><div className="space-y-4"><button onClick={()=>locs.length>0?setSc('map'):setSc('mode')}className="w-full bg-green-600 hover:bg-green-700 p-4 rounded-lg flex items-center justify-between"><span className="text-xl font-bold">{locs.length>0?'CONTINUAR':'JOGAR'}</span><span>→</span></button><button onClick={()=>setSc('inventory')}className="w-full bg-gray-700 hover:bg-gray-600 p-4 rounded-lg flex items-center justify-between"><span className="text-xl font-bold">Inventário</span><span className="text-gray-400">{inv.length}</span></button><button onClick={()=>setSc('missions')}className="w-full bg-gray-700 hover:bg-gray-600 p-4 rounded-lg flex items-center justify-between"><span className="text-xl font-bold">Missões</span><span className="text-gray-400">{miss.filter(m=>m.completed).length}/{miss.length}</span></button><button onClick={reset}className="w-full bg-red-900 hover:bg-red-800 p-4 rounded-lg font-bold">Resetar</button></div>{pt>=100&&<div className="mt-8 bg-gradient-to-r from-purple-600 to-pink-600 p-6 rounded-lg text-center"><h2 className="text-2xl font-bold mb-2">PARABÉNS!</h2><p>99 Noites Completas!</p><p className="text-sm mt-2">🏆 Mestre 🏆</p></div>}</div></div>;if(sc==='mode')return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6"><div className="max-w-md mx-auto"><button onClick={()=>setSc('menu')}className="mb-6 text-gray-400">← Voltar</button><h1 className="text-3xl font-bold text-center mb-8 text-green-400">Modo</h1><div className="space-y-4"><button onClick={genLocal}className="w-full bg-blue-600 hover:bg-blue-700 p-6 rounded-lg text-left"><h3 className="text-xl font-bold">🎯 Local</h3><p className="text-sm text-gray-300">15 pontos (50-150m)</p></button><button onClick={startJ}className="w-full bg-purple-600 hover:bg-purple-700 p-6 rounded-lg text-left"><h3 className="text-xl font-bold">🌆 Jurerê</h3><p className="text-sm text-gray-300">19 locais</p></button></div><div className="mt-6 bg-gray-800 rounded-lg p-4 text-sm text-gray-300"><p>💡 Raio: {R}m</p></div></div></div>;if(sc==='map')return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white"><div className="flex items-center justify-between p-4 bg-gray-800"><button onClick={()=>setSc('menu')}className="text-gray-400">← Menu</button><div className="text-center"><p className="text-sm">Pts</p><p className="text-xl font-bold text-green-400">{pt}</p></div><div className={`${rk.color} font-bold text-sm`}>{rk.icon}</div></div><div ref={m}style={{height:'400px',width:'100%'}}/><div className="p-4 space-y-4"><div className="bg-gray-800 rounded-lg p-4"><div className="flex items-center justify-between"><span>❤️ {hp}/100</span><span className="text-sm text-gray-400">{disc.length}/{locs.length}</span></div></div><div className="bg-gray-800 rounded-lg p-4"><h3 className="font-bold mb-3">Locais</h3>{!pos&&<p className="text-yellow-400 text-sm">📍 GPS...</p>}<div className="space-y-2 max-h-64 overflow-y-auto">{locs.map(l=>{const d=pos?dist(pos.lat,pos.lng,l.lat,l.lng):null,c=cr.find(x=>x.id===l.creature),di=disc.includes(l.id);return <div key={l.id}className={`p-3 rounded-lg ${di?'bg-green-900':d&&d<=R?'bg-yellow-900':'bg-gray-700'}`}><div className="flex items-center justify-between"><div className="flex items-center gap-3"><span className="text-2xl">{c.icon}</span><div><p className="font-bold text-sm">{l.name}</p><p className="text-xs text-gray-400">{c.name}</p></div></div><div className="text-right">{di?<span className="text-green-400 text-xs">✓</span>:d?<><p className="text-sm font-bold">{Math.round(d)}m</p>{d<=R+30&&!di&&<button onClick={()=>force(l)}className="mt-1 bg-orange-600 text-white text-xs px-2 py-1 rounded">Forçar</button>}</>:null}</div></div></div>})}</div></div><p className="text-center text-gray-400 text-xs">{R}m para capturar</p></div></div>;if(sc==='discovery'){const c=cur.creature;return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6 flex items-center justify-center"><div className="max-w-md mx-auto text-center"><div className="text-9xl mb-4">{c.icon}</div><h2 className="text-3xl font-bold mb-2">Encontrou!</h2><h3 className="text-2xl text-green-400 mb-4">{c.name}</h3><p className="text-lg mb-2">{c.rarity}</p><p className="text-3xl font-bold text-green-400">+{c.points}</p><button onClick={collect}className="mt-6 w-full bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg text-xl font-bold">COLETAR</button></div></div>}if(sc==='battle'&&en)return <div className="min-h-screen bg-gradient-to-b from-red-900 to-black text-white p-6"><div className="max-w-md mx-auto"><h2 className="text-2xl font-bold text-center mb-6 text-red-400">BATALHA!</h2><div className="bg-gray-800 rounded-lg p-6 mb-6 text-center"><div className="text-8xl mb-4">{en.icon}</div><h3 className="text-2xl font-bold mb-2">{en.name}</h3><p className="text-sm text-red-400">{en.rarity}</p><div className="mt-4"><div className="flex items-center justify-between mb-2"><span>Inimigo</span><span>{en.currentHealth}/{en.health}</span></div><div className="w-full bg-gray-700 rounded-full h-4"><div className="bg-red-500 h-4 rounded-full"style={{width:`${(en.currentHealth/en.health)*100}%`}}/></div></div></div><div className="bg-gray-800 rounded-lg p-4 mb-6"><div className="flex items-center justify-between mb-2"><span>Você</span><span>{hp}/100</span></div><div className="w-full bg-gray-700 rounded-full h-4"><div className="bg-green-500 h-4 rounded-full"style={{width:`${hp}%`}}/></div></div><div className="space-y-4"><button onClick={atk}className="w-full bg-red-600 hover:bg-red-700 p-4 rounded-lg text-xl font-bold">⚔️ ATACAR</button><button onClick={flee}className="w-full bg-gray-600 hover:bg-gray-700 p-4 rounded-lg text-xl font-bold">🛡️ FUGIR</button></div><div className="mt-6 text-center text-sm text-gray-400"><p>Ataque: 20 dano</p><p>Contra: {en.damage} dano</p></div></div></div>;if(sc==='inventory'){const grp=inv.reduce((a,i)=>{const e=a.find(x=>x.id===i.id);e?e.count++:a.push({...i,count:1});return a},[]);return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6"><div className="max-w-md mx-auto"><div className="flex items-center justify-between mb-6"><button onClick={()=>setSc('menu')}className="text-gray-400">←</button><h1 className="text-2xl font-bold">Inventário</h1><div className="w-16"/></div><div className="bg-gray-800 rounded-lg p-4 mb-6"><div className="flex items-center justify-between"><div><p className="text-gray-400">Total</p><p className="text-3xl font-bold text-green-400">{pt}</p></div><div className="text-right"><p className="text-gray-400">Itens</p><p className="text-3xl font-bold">{inv.length}</p></div></div></div>{grp.length===0?<div className="text-center py-12 text-gray-400"><p>Vazio</p></div>:<div className="grid grid-cols-2 gap-4">{grp.map((i,x)=><div key={x}className={`rounded-lg p-4 text-center ${i.type==='legendary'?'bg-gradient-to-br from-purple-600 to-pink-600':i.type==='epic'?'bg-gradient-to-br from-yellow-600 to-orange-600':i.type==='rare'?'bg-gradient-to-br from-blue-600 to-cyan-600':'bg-gray-700'}`}><div className="text-5xl mb-2">{i.icon}</div><p className="font-bold text-sm mb-1">{i.name}</p><p className="text-xs">{i.rarity}</p><p className="text-lg font-bold mt-2">x{i.count}</p><p className="text-xs">{i.points}pts</p></div>)}</div>}</div></div>}if(sc==='missions')return <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6"><div className="max-w-md mx-auto"><div className="flex items-center justify-between mb-6"><button onClick={()=>setSc('menu')}className="text-gray-400">←</button><h1 className="text-2xl font-bold">Missões</h1><div className="w-16"/></div><div className="space-y-4">{miss.map(ms=><div key={ms.id}className={`rounded-lg p-4 ${ms.completed?'bg-green-900':'bg-gray-800'}`}><div className="flex items-center justify-between mb-2"><h3 className="font-bold">{ms.completed?'✓':'○'} {ms.name}</h3><span className="text-yellow-400 font-bold">+{ms.reward}</span></div><div className="flex items-center gap-3"><div className="flex-1 bg-gray-700 rounded-full h-3"><div className={`h-3 rounded-full ${ms.completed?'bg-green-500':'bg-blue-500'}`}style={{width:`${(ms.progress/ms.target)*100}%`}}/></div><span className="text-sm">{ms.progress}/{ms.target}</span></div>{ms.completed&&<p className="text-green-400 text-sm mt-2">✓ Ok!</p>}</div>)}</div></div></div>;return null};ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
