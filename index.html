import React, { useState, useEffect } from 'react';
import { MapPin, Trophy, Backpack, Target, Plus, Play, Settings, Award, Heart, Sword, Shield, ChevronRight } from 'lucide-react';

const App = () => {
  const [screen, setScreen] = useState('splash');
  const [points, setPoints] = useState(0);
  const [playerHealth, setPlayerHealth] = useState(100);
  const [inventory, setInventory] = useState([]);
  const [discoveredLocations, setDiscoveredLocations] = useState([]);
  const [currentLocation, setCurrentLocation] = useState(null);
  const [userPosition, setUserPosition] = useState(null);
  const [gameMode, setGameMode] = useState(null);
  const [locations, setLocations] = useState([]);
  const [inBattle, setInBattle] = useState(false);
  const [enemy, setEnemy] = useState(null);
  const [missions, setMissions] = useState([
    { id: 1, name: 'Encontre 3 Cultistas', progress: 0, target: 3, reward: 15, completed: false },
    { id: 2, name: 'Colete 5 Itens', progress: 0, target: 5, reward: 10, completed: false },
    { id: 3, name: 'Derrote o Alpha Wolf', progress: 0, target: 1, reward: 30, completed: false }
  ]);

  // Criaturas e itens do 99 Noites
  const creatures = [
    // LEND√ÅRIOS (30 pts)
    { id: 'deer', name: 'O Cervo (Wendigo)', type: 'legendary', points: 30, rarity: 'Lend√°rio', isEnemy: true, health: 100, damage: 25, icon: 'ü¶å' },
    { id: 'owl', name: 'A Coruja', type: 'legendary', points: 30, rarity: 'Lend√°rio', isEnemy: true, health: 80, damage: 20, icon: 'ü¶â' },
    { id: 'ram', name: 'O Carneiro', type: 'legendary', points: 30, rarity: 'Lend√°rio', isEnemy: true, health: 90, damage: 22, icon: 'üêè' },
    
    // √âPICOS (20 pts)
    { id: 'alpha_wolf', name: 'Alpha Wolf', type: 'epic', points: 20, rarity: '√âpico', isEnemy: true, health: 60, damage: 18, icon: 'üê∫' },
    { id: 'cultist_king', name: 'Cultist King', type: 'epic', points: 20, rarity: '√âpico', isEnemy: true, health: 70, damage: 20, icon: 'üëë' },
    { id: 'bear', name: 'Urso', type: 'epic', points: 20, rarity: '√âpico', isEnemy: true, health: 80, damage: 25, icon: 'üêª' },
    { id: 'flashlight', name: 'Lanterna', type: 'epic', points: 20, rarity: '√âpico', isEnemy: false, icon: 'üî¶' },
    { id: 'katana', name: 'Katana', type: 'epic', points: 20, rarity: '√âpico', isEnemy: false, icon: '‚öîÔ∏è' },
    
    // RAROS (10 pts)
    { id: 'wolf', name: 'Lobo', type: 'rare', points: 10, rarity: 'Raro', isEnemy: true, health: 40, damage: 12, icon: 'üê∫' },
    { id: 'cultist', name: 'Cultista', type: 'rare', points: 10, rarity: 'Raro', isEnemy: true, health: 30, damage: 10, icon: 'üßô' },
    { id: 'crossbow_cultist', name: 'Cultista Arqueiro', type: 'rare', points: 10, rarity: 'Raro', isEnemy: true, health: 25, damage: 15, icon: 'üèπ' },
    { id: 'fox', name: 'Raposa √Årtica', type: 'rare', points: 10, rarity: 'Raro', isEnemy: false, icon: 'ü¶ä' },
    { id: 'torch', name: 'Tocha', type: 'rare', points: 10, rarity: 'Raro', isEnemy: false, icon: 'üî•' },
    { id: 'armor', name: 'Armadura', type: 'rare', points: 10, rarity: 'Raro', isEnemy: false, icon: 'üõ°Ô∏è' },
    
    // COMUNS (5 pts)
    { id: 'rabbit', name: 'Coelho', type: 'common', points: 5, rarity: 'Comum', isEnemy: false, icon: 'üê∞' },
    { id: 'wood', name: 'Madeira', type: 'common', points: 5, rarity: 'Comum', isEnemy: false, icon: 'ü™µ' },
    { id: 'mushroom', name: 'Cogumelo', type: 'common', points: 5, rarity: 'Comum', isEnemy: false, icon: 'üçÑ' },
    { id: 'crystal', name: 'Cristal', type: 'common', points: 5, rarity: 'Comum', isEnemy: false, icon: 'üíé' },
    { id: 'branch', name: 'Galho M√°gico', type: 'common', points: 5, rarity: 'Comum', isEnemy: false, icon: 'üåø' }
  ];

  // Pontos de interesse em Jurer√™ (coordenadas reais aproximadas)
  const jurereLocations = [
    { lat: -27.4521, lng: -48.4947, name: 'Praia de Jurer√™ Internacional', creature: 'deer' },
    { lat: -27.4535, lng: -48.4962, name: 'Jurer√™ Open Shopping', creature: 'cultist_king' },
    { lat: -27.4510, lng: -48.4930, name: 'Pra√ßa da Praia', creature: 'alpha_wolf' },
    { lat: -27.4528, lng: -48.4955, name: 'Avenida dos B√∫zios', creature: 'owl' },
    { lat: -27.4515, lng: -48.4940, name: 'Cal√ßad√£o', creature: 'wolf' },
    { lat: -27.4540, lng: -48.4970, name: 'Parque Jurer√™', creature: 'bear' },
    { lat: -27.4505, lng: -48.4925, name: 'P√≠er de Jurer√™', creature: 'cultist' },
    { lat: -27.4525, lng: -48.4950, name: 'Mirante da Praia', creature: 'flashlight' },
    { lat: -27.4518, lng: -48.4945, name: 'Quiosque Central', creature: 'torch' },
    { lat: -27.4512, lng: -48.4935, name: 'Bosque', creature: 'rabbit' }
  ];

  // Inicializar GPS
  useEffect(() => {
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(
        (position) => {
          setUserPosition({
            lat: position.coords.latitude,
            lng: position.coords.longitude
          });
        },
        (error) => console.log('GPS Error:', error),
        { enableHighAccuracy: true, maximumAge: 10000, timeout: 5000 }
      );
    }
  }, []);

  // Calcular dist√¢ncia entre dois pontos (em metros)
  const calculateDistance = (lat1, lng1, lat2, lng2) => {
    const R = 6371e3; // Raio da Terra em metros
    const œÜ1 = lat1 * Math.PI / 180;
    const œÜ2 = lat2 * Math.PI / 180;
    const ŒîœÜ = (lat2 - lat1) * Math.PI / 180;
    const ŒîŒª = (lng2 - lng1) * Math.PI / 180;

    const a = Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +
              Math.cos(œÜ1) * Math.cos(œÜ2) *
              Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

    return R * c;
  };

  // Verificar locais pr√≥ximos
  useEffect(() => {
    if (userPosition && locations.length > 0) {
      locations.forEach(loc => {
        if (!discoveredLocations.includes(loc.id)) {
          const distance = calculateDistance(
            userPosition.lat, userPosition.lng,
            loc.lat, loc.lng
          );
          
          if (distance <= 15) { // 15 metros
            handleDiscoverLocation(loc);
          }
        }
      });
    }
  }, [userPosition, locations]);

  // Descobrir local
  const handleDiscoverLocation = (location) => {
    const creature = creatures.find(c => c.id === location.creature);
    setCurrentLocation({ ...location, creature });
    setDiscoveredLocations([...discoveredLocations, location.id]);
    
    if (creature.isEnemy) {
      setEnemy({ ...creature, currentHealth: creature.health });
      setInBattle(true);
      setScreen('battle');
    } else {
      setScreen('discovery');
    }
  };

  // Coletar item
  const collectItem = () => {
    const creature = currentLocation.creature;
    setPoints(points + creature.points);
    setInventory([...inventory, creature]);
    
    // Atualizar miss√µes
    updateMissions(creature);
    
    setScreen('map');
    setCurrentLocation(null);
  };

  // Atualizar miss√µes
  const updateMissions = (creature) => {
    const newMissions = missions.map(mission => {
      if (mission.id === 1 && creature.id.includes('cultist') && !mission.completed) {
        const newProgress = mission.progress + 1;
        if (newProgress >= mission.target) {
          setPoints(p => p + mission.reward);
          return { ...mission, progress: newProgress, completed: true };
        }
        return { ...mission, progress: newProgress };
      }
      if (mission.id === 2 && !mission.completed) {
        const newProgress = mission.progress + 1;
        if (newProgress >= mission.target) {
          setPoints(p => p + mission.reward);
          return { ...mission, progress: newProgress, completed: true };
        }
        return { ...mission, progress: newProgress };
      }
      return mission;
    });
    setMissions(newMissions);
  };

  // Sistema de batalha
  const attack = () => {
    const playerDamage = 20;
    const newEnemyHealth = enemy.currentHealth - playerDamage;
    
    if (newEnemyHealth <= 0) {
      // Vit√≥ria
      setPoints(points + enemy.points);
      setInventory([...inventory, enemy]);
      
      // Atualizar miss√£o de Alpha Wolf
      if (enemy.id === 'alpha_wolf') {
        const newMissions = missions.map(m => 
          m.id === 3 ? { ...m, progress: 1, completed: true } : m
        );
        setMissions(newMissions);
        setPoints(p => p + 30);
      }
      
      updateMissions(enemy);
      setInBattle(false);
      setEnemy(null);
      setScreen('map');
    } else {
      setEnemy({ ...enemy, currentHealth: newEnemyHealth });
      
      // Inimigo ataca de volta
      setTimeout(() => {
        const newPlayerHealth = playerHealth - enemy.damage;
        if (newPlayerHealth <= 0) {
          setPlayerHealth(0);
          alert('Voc√™ foi derrotado! Retornando ao acampamento...');
          setInBattle(false);
          setEnemy(null);
          setPlayerHealth(100);
          setScreen('map');
        } else {
          setPlayerHealth(newPlayerHealth);
        }
      }, 500);
    }
  };

  const flee = () => {
    setInBattle(false);
    setEnemy(null);
    setScreen('map');
  };

  // Gerar pontos aleat√≥rios no modo local
  const generateLocalPoints = () => {
    if (!userPosition) {
      alert('Aguardando localiza√ß√£o GPS...');
      return;
    }
    
    const newLocations = [];
    for (let i = 0; i < 10; i++) {
      const randomCreature = creatures[Math.floor(Math.random() * creatures.length)];
      const angle = Math.random() * 2 * Math.PI;
      const distance = 50 + Math.random() * 400; // 50-450 metros
      
      const lat = userPosition.lat + (distance / 111000) * Math.cos(angle);
      const lng = userPosition.lng + (distance / (111000 * Math.cos(userPosition.lat * Math.PI / 180))) * Math.sin(angle);
      
      newLocations.push({
        id: `local_${i}`,
        lat,
        lng,
        name: `Ponto ${i + 1}`,
        creature: randomCreature.id
      });
    }
    
    setLocations(newLocations);
    setGameMode('local');
    setScreen('map');
  };

  // Modo Jurer√™
  const startJurereMode = () => {
    const locationsWithId = jurereLocations.map((loc, i) => ({ ...loc, id: `jurere_${i}` }));
    setLocations(locationsWithId);
    setGameMode('jurere');
    setScreen('map');
  };

  // Calcular ranking
  const getRank = () => {
    if (points >= 76) return { name: 'Diamante', icon: 'üíé', color: 'text-cyan-400' };
    if (points >= 51) return { name: 'Ouro', icon: 'ü•á', color: 'text-yellow-400' };
    if (points >= 26) return { name: 'Prata', icon: 'ü•à', color: 'text-gray-300' };
    return { name: 'Bronze', icon: 'ü•â', color: 'text-orange-400' };
  };

  const rank = getRank();

  // TELAS

  // Splash Screen
  if (screen === 'splash') {
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 via-green-900 to-black flex flex-col items-center justify-center p-6">
        <div className="text-center space-y-6 animate-fade-in">
          <div className="text-8xl mb-4">üå≤</div>
          <h1 className="text-4xl font-bold text-white mb-2">Floresta das</h1>
          <h1 className="text-5xl font-bold text-green-400 mb-4">99 Noites</h1>
          <p className="text-xl text-gray-300">Jurer√™</p>
          <button
            onClick={() => setScreen('menu')}
            className="mt-8 bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg text-xl font-bold transition-all transform hover:scale-105"
          >
            INICIAR AVENTURA
          </button>
        </div>
      </div>
    );
  }

  // Menu Principal
  if (screen === 'menu') {
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6">
        <div className="max-w-md mx-auto">
          <h1 className="text-3xl font-bold text-center mb-8 text-green-400">Menu Principal</h1>
          
          <div className="bg-gray-800 rounded-lg p-4 mb-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-gray-400">Pontos</p>
                <p className="text-3xl font-bold">{points}/100</p>
              </div>
              <div className="text-right">
                <p className="text-gray-400">Ranking</p>
                <p className={`text-2xl font-bold ${rank.color}`}>{rank.icon} {rank.name}</p>
              </div>
            </div>
            <div className="w-full bg-gray-700 rounded-full h-3 mt-4">
              <div 
                className="bg-green-500 h-3 rounded-full transition-all"
                style={{ width: `${points}%` }}
              />
            </div>
          </div>

          <div className="space-y-4">
            <button
              onClick={() => setScreen('mode')}
              className="w-full bg-green-600 hover:bg-green-700 p-4 rounded-lg flex items-center justify-between transition-all"
            >
              <div className="flex items-center gap-3">
                <Play className="w-6 h-6" />
                <span className="text-xl font-bold">JOGAR</span>
              </div>
              <ChevronRight className="w-6 h-6" />
            </button>

            <button
              onClick={() => setScreen('inventory')}
              className="w-full bg-gray-700 hover:bg-gray-600 p-4 rounded-lg flex items-center justify-between transition-all"
            >
              <div className="flex items-center gap-3">
                <Backpack className="w-6 h-6" />
                <span className="text-xl font-bold">Invent√°rio</span>
              </div>
              <span className="text-gray-400">{inventory.length} itens</span>
            </button>

            <button
              onClick={() => setScreen('missions')}
              className="w-full bg-gray-700 hover:bg-gray-600 p-4 rounded-lg flex items-center justify-between transition-all"
            >
              <div className="flex items-center gap-3">
                <Target className="w-6 h-6" />
                <span className="text-xl font-bold">Miss√µes</span>
              </div>
              <span className="text-gray-400">{missions.filter(m => m.completed).length}/{missions.length}</span>
            </button>
          </div>

          {points >= 100 && (
            <div className="mt-8 bg-gradient-to-r from-purple-600 to-pink-600 p-6 rounded-lg text-center animate-pulse">
              <Award className="w-16 h-16 mx-auto mb-4" />
              <h2 className="text-2xl font-bold mb-2">PARAB√âNS!</h2>
              <p className="text-lg">Voc√™ completou as 99 Noites!</p>
              <p className="text-sm mt-2">üèÜ Mestre da Floresta üèÜ</p>
            </div>
          )}
        </div>
      </div>
    );
  }

  // Escolher Modo
  if (screen === 'mode') {
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6">
        <div className="max-w-md mx-auto">
          <button onClick={() => setScreen('menu')} className="mb-6 text-gray-400 hover:text-white">
            ‚Üê Voltar
          </button>
          
          <h1 className="text-3xl font-bold text-center mb-8 text-green-400">Escolha o Modo</h1>

          <div className="space-y-4">
            <button
              onClick={generateLocalPoints}
              className="w-full bg-blue-600 hover:bg-blue-700 p-6 rounded-lg text-left transition-all"
            >
              <div className="flex items-center gap-4 mb-2">
                <MapPin className="w-8 h-8" />
                <div>
                  <h3 className="text-xl font-bold">üéØ Modo Local</h3>
                  <p className="text-sm text-gray-300">Gera 10 pontos perto de voc√™</p>
                </div>
              </div>
              <p className="text-xs text-gray-400 mt-2">Perfeito para jogar em uma pra√ßa ou praia</p>
            </button>

            <button
              onClick={startJurereMode}
              className="w-full bg-purple-600 hover:bg-purple-700 p-6 rounded-lg text-left transition-all"
            >
              <div className="flex items-center gap-4 mb-2">
                <Trophy className="w-8 h-8" />
                <div>
                  <h3 className="text-xl font-bold">üåÜ Modo Jurer√™</h3>
                  <p className="text-sm text-gray-300">Aventura completa pela regi√£o</p>
                </div>
              </div>
              <p className="text-xs text-gray-400 mt-2">10+ pontos fixos em Jurer√™ Internacional</p>
            </button>

            <button
              onClick={() => alert('Modo Criador em breve!')}
              className="w-full bg-gray-700 hover:bg-gray-600 p-6 rounded-lg text-left transition-all"
            >
              <div className="flex items-center gap-4 mb-2">
                <Plus className="w-8 h-8" />
                <div>
                  <h3 className="text-xl font-bold">‚úèÔ∏è Modo Criador</h3>
                  <p className="text-sm text-gray-300">Adicione seus pr√≥prios pontos</p>
                </div>
              </div>
              <p className="text-xs text-gray-400 mt-2">Em desenvolvimento</p>
            </button>
          </div>
        </div>
      </div>
    );
  }

  // Mapa
  if (screen === 'map') {
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-4">
        <div className="max-w-md mx-auto">
          <div className="flex items-center justify-between mb-4">
            <button onClick={() => setScreen('menu')} className="text-gray-400 hover:text-white">
              ‚Üê Menu
            </button>
            <div className="text-right">
              <p className="text-sm text-gray-400">Pontos</p>
              <p className="text-2xl font-bold text-green-400">{points}/100</p>
            </div>
          </div>

          <div className="bg-gray-800 rounded-lg p-4 mb-4">
            <div className="flex items-center justify-between mb-2">
              <div className="flex items-center gap-2">
                <Heart className="w-5 h-5 text-red-500" />
                <span>Vida: {playerHealth}/100</span>
              </div>
              <div className={`${rank.color} font-bold`}>
                {rank.icon} {rank.name}
              </div>
            </div>
            <div className="w-full bg-gray-700 rounded-full h-2">
              <div 
                className="bg-green-500 h-2 rounded-full transition-all"
                style={{ width: `${points}%` }}
              />
            </div>
          </div>

          <div className="bg-gray-800 rounded-lg p-4 mb-4">
            <h3 className="font-bold mb-2 flex items-center gap-2">
              <MapPin className="w-5 h-5" />
              Locais Pr√≥ximos
            </h3>
            {!userPosition && (
              <p className="text-yellow-400 text-sm">üìç Aguardando GPS...</p>
            )}
            {userPosition && locations.length === 0 && (
              <p className="text-gray-400 text-sm">Nenhum local gerado ainda</p>
            )}
            <div className="space-y-2 mt-3 max-h-96 overflow-y-auto">
              {locations.map(loc => {
                const distance = userPosition ? calculateDistance(
                  userPosition.lat, userPosition.lng,
                  loc.lat, loc.lng
                ) : null;
                const creature = creatures.find(c => c.id === loc.creature);
                const discovered = discoveredLocations.includes(loc.id);
                
                return (
                  <div 
                    key={loc.id}
                    className={`p-3 rounded-lg ${discovered ? 'bg-green-900' : distance && distance <= 15 ? 'bg-yellow-900 animate-pulse' : 'bg-gray-700'}`}
                  >
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <span className="text-3xl">{creature.icon}</span>
                        <div>
                          <p className="font-bold">{loc.name}</p>
                          <p className="text-xs text-gray-400">{creature.name}</p>
                          <p className={`text-xs ${
                            creature.type === 'legendary' ? 'text-purple-400' :
                            creature.type === 'epic' ? 'text-yellow-400' :
                            creature.type === 'rare' ? 'text-blue-400' :
                            'text-gray-400'
                          }`}>
                            {creature.rarity} ‚Ä¢ {creature.points} pts
                          </p>
                        </div>
                      </div>
                      <div className="text-right">
                        {discovered ? (
                          <span className="text-green-400 text-xs">‚úì Coletado</span>
                        ) : distance ? (
                          <>
                            <p className="text-sm font-bold">{Math.round(distance)}m</p>
                            {distance <= 15 && (
                              <p className="text-yellow-400 text-xs">Pr√≥ximo!</p>
                            )}
                          </>
                        ) : null}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          <p className="text-center text-gray-400 text-sm">
            Aproxime-se a 15 metros dos locais para descobri-los
          </p>
        </div>
      </div>
    );
  }

  // Descoberta
  if (screen === 'discovery') {
    const creature = currentLocation.creature;
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6 flex items-center justify-center">
        <div className="max-w-md mx-auto text-center">
          <div className="mb-6">
            <div className="text-9xl mb-4 animate-bounce">{creature.icon}</div>
            <h2 className="text-3xl font-bold mb-2">Voc√™ encontrou!</h2>
            <h3 className="text-2xl text-green-400 mb-4">{creature.name}</h3>
            <p className={`text-lg mb-2 ${
              creature.type === 'legendary' ? 'text-purple-400' :
              creature.type === 'epic' ? 'text-yellow-400' :
              creature.type === 'rare' ? 'text-blue-400' :
              'text-gray-400'
            }`}>
              {creature.rarity}
            </p>
            <p className="text-3xl font-bold text-green-400">+{creature.points} pontos</p>
          </div>

          <button
            onClick={collectItem}
            className="w-full bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg text-xl font-bold transition-all transform hover:scale-105"
          >
            COLETAR
          </button>
        </div>
      </div>
    );
  }

  // Batalha
  if (screen === 'battle' && enemy) {
    return (
      <div className="min-h-screen bg-gradient-to-b from-red-900 to-black text-white p-6">
        <div className="max-w-md mx-auto">
          <h2 className="text-2xl font-bold text-center mb-6 text-red-400">BATALHA!</h2>

          <div className="bg-gray-800 rounded-lg p-6 mb-6 text-center">
            <div className="text-8xl mb-4">{enemy.icon}</div>
            <h3 className="text-2xl font-bold mb-2">{enemy.name}</h3>
            <p className={`text-sm ${
              enemy.type === 'legendary' ? 'text-purple-400' :
              enemy.type === 'epic' ? 'text-yellow-400' :
              'text-red-400'
            }`}>
              {enemy.rarity}
            </p>
            <div className="mt-4">
              <div className="flex items-center justify-between mb-2">
                <span>Vida do Inimigo</span>
                <span>{enemy.currentHealth}/{enemy.health}</span>
              </div>
              <div className="w-full bg-gray-700 rounded-full h-4">
                <div 
                  className="bg-red-500 h-4 rounded-full transition-all"
                  style={{ width: `${(enemy.currentHealth / enemy.health) * 100}%` }}
                />
              </div>
            </div>
          </div>

          <div className="bg-gray-800 rounded-lg p-4 mb-6">
            <div className="flex items-center justify-between mb-2">
              <span>Sua Vida</span>
              <span>{playerHealth}/100</span>
            </div>
            <div className="w-full bg-gray-700 rounded-full h-4">
              <div 
                className="bg-green-500 h-4 rounded-full transition-all"
                style={{ width: `${playerHealth}%` }}
              />
            </div>
          </div>

          <div className="space-y-4">
            <button
              onClick={attack}
              className="w-full bg-red-600 hover:bg-red-700 p-4 rounded-lg flex items-center justify-center gap-3 text-xl font-bold transition-all"
            >
              <Sword className="w-6 h-6" />
              ATACAR
            </button>

            <button
              onClick={flee}
              className="w-full bg-gray-600 hover:bg-gray-700 p-4 rounded-lg flex items-center justify-center gap-3 text-xl font-bold transition-all"
            >
              <Shield className="w-6 h-6" />
              FUGIR
            </button>
          </div>

          <div className="mt-6 text-center text-sm text-gray-400">
            <p>üí° Dica: Cada ataque causa 20 de dano</p>
            <p>‚ö†Ô∏è O inimigo contra-ataca causando {enemy.damage} de dano</p>
          </div>
        </div>
      </div>
    );
  }

  // Invent√°rio
  if (screen === 'inventory') {
    const groupedInventory = inventory.reduce((acc, item) => {
      const existing = acc.find(i => i.id === item.id);
      if (existing) {
        existing.count++;
      } else {
        acc.push({ ...item, count: 1 });
      }
      return acc;
    }, []);

    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6">
        <div className="max-w-md mx-auto">
          <div className="flex items-center justify-between mb-6">
            <button onClick={() => setScreen('menu')} className="text-gray-400 hover:text-white">
              ‚Üê Voltar
            </button>
            <h1 className="text-2xl font-bold">Invent√°rio</h1>
            <div className="w-16"></div>
          </div>

          <div className="bg-gray-800 rounded-lg p-4 mb-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-gray-400">Total de Pontos</p>
                <p className="text-3xl font-bold text-green-400">{points}</p>
              </div>
              <div className="text-right">
                <p className="text-gray-400">Itens Coletados</p>
                <p className="text-3xl font-bold">{inventory.length}</p>
              </div>
            </div>
          </div>

          {groupedInventory.length === 0 ? (
            <div className="text-center py-12 text-gray-400">
              <Backpack className="w-16 h-16 mx-auto mb-4 opacity-50" />
              <p>Seu invent√°rio est√° vazio</p>
              <p className="text-sm mt-2">Explore o mapa para coletar itens!</p>
            </div>
          ) : (
            <div className="grid grid-cols-2 gap-4">
              {groupedInventory.map((item, index) => (
                <div 
                  key={index}
                  className={`rounded-lg p-4 text-center ${
                    item.type === 'legendary' ? 'bg-gradient-to-br from-purple-600 to-pink-600' :
                    item.type === 'epic' ? 'bg-gradient-to-br from-yellow-600 to-orange-600' :
                    item.type === 'rare' ? 'bg-gradient-to-br from-blue-600 to-cyan-600' :
                    'bg-gray-700'
                  }`}
                >
                  <div className="text-5xl mb-2">{item.icon}</div>
                  <p className="font-bold text-sm mb-1">{item.name}</p>
                  <p className="text-xs text-gray-200">{item.rarity}</p>
                  <p className="text-lg font-bold mt-2">x{item.count}</p>
                  <p className="text-xs text-gray-200">{item.points} pts cada</p>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    );
  }

  // Miss√µes
  if (screen === 'missions') {
    return (
      <div className="min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-6">
        <div className="max-w-md mx-auto">
          <div className="flex items-center justify-between mb-6">
            <button onClick={() => setScreen('menu')} className="text-gray-400 hover:text-white">
              ‚Üê Voltar
            </button>
            <h1 className="text-2xl font-bold">Miss√µes</h1>
            <div className="w-16"></div>
          </div>

          <div className="space-y-4">
            {missions.map(mission => (
              <div 
                key={mission.id}
                className={`rounded-lg p-4 ${mission.completed ? 'bg-green-900' : 'bg-gray-800'}`}
              >
                <div className="flex items-center justify-between mb-2">
                  <h3 className="font-bold flex items-center gap-2">
                    {mission.completed ? '‚úì' : '‚óã'} {mission.name}
                  </h3>
                  <span className="text-yellow-400 font-bold">+{mission.reward} pts</span>
                </div>
                <div className="flex items-center gap-3">
                  <div className="flex-1 bg-gray-700 rounded-full h-3">
                    <div 
                      className={`h-3 rounded-full transition-all ${mission.completed ? 'bg-green-500' : 'bg-blue-500'}`}
                      style={{ width: `${(mission.progress / mission.target) * 100}%` }}
                    />
                  </div>
                  <span className="text-sm">{mission.progress}/{mission.target}</span>
                </div>
                {mission.completed && (
                  <p className="text-green-400 text-sm mt-2">‚úì Miss√£o Completa!</p>
                )}
              </div>
            ))}
          </div>

          <div className="mt-8 bg-gray-800 rounded-lg p-4 text-center">
            <p className="text-gray-400 text-sm">
              Complete miss√µes para ganhar pontos extras!
            </p>
          </div>
        </div>
      </div>
    );
  }

  return null;
};

export default App;
